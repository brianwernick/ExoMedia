import org.jetbrains.kotlin.gradle.dsl.JvmTarget

plugins {
  alias libs.plugins.android.library
  alias libs.plugins.kotlin.android
}

afterEvaluate {
  apply from: '../gradle/release/publish.gradle'
}

dependencies {
  api libs.kotlin.stdlib.jdk7

  implementation libs.appcompat
  implementation libs.constraintlayout

  // ExoPlayer
  api libs.media3.exoplayer
  api libs.media3.exoplayer.dash
  api libs.media3.exoplayer.hls
  api libs.media3.exoplayer.smoothstreaming

  testImplementation libs.junit
  testImplementation libs.robolectric
}

android {
  namespace 'com.devbrackets.android.exomedia'
  compileSdk 35

  defaultConfig {
    minSdkVersion 21
    targetSdkVersion 35

    vectorDrawables.useSupportLibrary = true

    buildConfigField "String", "EXO_MEDIA_VERSION_NAME", "\"${rootProject.ext.libraryInfo.versionName}\""
  }

  sourceSets {
    main.java.srcDirs += "src/main/kotlin"
    test.java.srcDirs += "src/test/kotlin"
  }

  buildFeatures {
    buildConfig true
  }

  compileOptions {
    sourceCompatibility JavaVersion.VERSION_11
    targetCompatibility JavaVersion.VERSION_11
  }

  kotlinOptions {
    jvmTarget = JavaVersion.VERSION_11
  }

  testOptions {
    unitTests {
      includeAndroidResources = true
    }
  }

  lint {
    abortOnError false
  }
}

kotlin {
  compilerOptions {
    jvmTarget.set(JvmTarget.JVM_11)
  }
}